import subprocess
import socket
from scapy.all import *

def whois():
	host=raw_input("Digite o host alvo: ")
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(("200.160.2.3",43))
	s.send(host+"\r\n")
	resp = s.recv(1024)
	print resp


def sniffersenha():
	def imprimir(pacotes):
    		hd = str(pacotes[TCP].payload)[0:4]
    		if hd == 'POST':
        		print pacotes[TCP].payload

	sniff(filter='port 80', store=0, prn=imprimir)


def snifer():
	def imprimir(pacotes):
    		print pacotes[TCP].payload

	sniff(filter='port 80', store=0, prn=imprimir)


def scanner():
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	host = raw_input("Digite o site ou ip que deseja scannear: ")
	print "1 - Testar um porta especifica:"
	print "2 - Teste um range de portas: "

	a = input("Informe um opcao: ")

	if a==1:
		porta = input("Digite uma porta: ")
		while porta != 0:
	    		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	    		s.settimeout(1.0)
	    		conexao = s.connect_ex((host, porta))
	    		if(conexao == 0):
		       		print (porta, " Porta aberta")
				porta = 0
			else:
				print "Porta fechada"
				porta = 0
	elif a==2:
		r = input("Informe um range de portas que deseja scannear:")
		for port in range(0,r):
		        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		        s.settimeout(1.0)
		        conexao = s.connect_ex((host, port))
		        if(conexao == 0):
		        	print (port, ": Porta aberta")
		        else:
		       		print (port, ": Porta fechada")






print"|  _ \ _ __ ___   __ _ _ __ __ _ _ __ ___    / \   _ __   __| | | | | __ _ "
print"| |_) | '__/ _ \ / _` | '__/ _` | '_ ` _ \  / _ \ | '_ \ / _` | |_| |/ _` |"
print"|  __/| | | (_) | (_| | | | (_| | | | | | |/ ___ \| | | | (_| |  _  | (_| |"
print"|_|   |_|  \___/ \__, |_|  \__,_|_| |_| |_/_/   \_\_| |_|\__,_|_| |_|\__,_|"
print"                 |___/                         "                            
print"      _    _            _____           _     "
print"  ___| | _(_)_ __   __ |_   _|__   ___ | |___ "
print" / __| |/ / | '_ \ / _` || |/ _ \ / _ \| / __|"
print "| (__|   <| | | | | (_| || | (_) | (_) | \__ \""
print " \___|_|\_\_|_| |_|\__, ||_|\___/ \___/|_|___/"
print "                   |___/ "


print " 1- Whois "
print " 2- Backdoor"
print " 3- Snnifer"
print " 4- Snnifer de senhas"
print " 5- Servidor para Shell reversa"
print " 6- Scanner de portas"
print " 7- Pegar subdominios de um site"

opcao = input("Entre com uma ferramenta: ")
if opcao==1:
	whois()
elif opcao==2:
	return_code = subprocess.call("nano backdoor.py", shell=True)
elif opcao==3:
	snifer()
elif opcao==4:
	sniffersenha()
elif opcao==5:
	return_code = subprocess.call("./serve.sh", shell=True)
elif opcao==6:
	scanner()
elif opcao==7:
	turn_code = subprocess.call("./pegarsub.sh", shell=True)
